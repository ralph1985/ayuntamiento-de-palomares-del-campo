---
export const prerender = false;

const supported = ['es', 'en'];

const header = Astro.request.headers.get('accept-language') ?? '';
const locales = header
  .split(',')
  .map(part => part.trim().split(';')[0] || '')
  .filter(Boolean)
  .map(code => code.split('-')[0].toLowerCase());

const target =
  locales.find(code => supported.includes(code)) ??
  (locales.length ? 'en' : 'en');

return Astro.redirect(`/${target}`);
---
